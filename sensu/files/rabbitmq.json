{%- from "sensu/map.jinja" import server with context %}
{%- from "sensu/map.jinja" import client with context %}
{
  {%- if pillar.sensu.server is defined %}
  "rabbitmq": {
    "host": "{{ server.message_queue.host }}",
    "port": {{ server.message_queue.port }},
    "user": "{{ server.message_queue.user }}",
    "password": "{{ server.message_queue.password }}",
    "vhost": "{{ server.message_queue.virtual_host }}"
  }
  {%- else %}
  "rabbitmq": {
    "host": "{{ client.message_queue.host }}",
    "port": {{ client.message_queue.port }},
    "user": "{{ client.message_queue.user }}",
    "password": "{{ client.message_queue.password }}",
    "vhost": "{{ client.message_queue.virtual_host }}"
  }
  {%- endif %}
}